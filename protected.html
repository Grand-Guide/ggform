<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grand Guide - WikiForm</title>
    <link rel="stylesheet" href="protect.css">

</head>
<body>
    <div class="container">
        <h1>Formulário de Itens</h1>

        <!-- Botões para escolher entre adicionar ou editar item -->
        <div class="button-group">
            <button class="button" id="addItemBtn">Adicionar Item</button>
            <button class="button" id="editItemBtn">Editar Item</button>
        </div>

        <!-- Formulário de adição e edição de itens -->
        <div class="form-section" id="itemForm">
            <h2 id="formTitle">Adicionar Item</h2>

            <div class="form-group">
                <label for="itemId">ID:</label>
                <input type="text" id="itemId">
            </div>

            <div class="form-group">
                <label for="itemName">Nome:</label>
                <input type="text" id="itemName">
            </div>

            <div class="form-group">
                <label for="itemDescription">Descrição:</label>
                <input type="text" id="itemDescription">
            </div>

            <div class="form-group">
                <label for="itemPrice">Preço:</label>
                <input type="text" id="itemPrice">
            </div>

            <div class="form-group">
                <label for="itemStatus">Status:</label>
                <input type="text" id="itemStatus">
            </div>

            <!-- Outros campos... -->

            <div class="button-group">
                <button class="button" id="saveBtn">Salvar</button>
            </div>
        </div>

        <!-- Barra de pesquisa para selecionar itens ao editar -->
        <div class="search-bar form-section" id="searchBar">
            <h2>Pesquisar Item para Editar</h2>
            <input type="text" id="searchInput" placeholder="Digite o nome ou ID do item">
        </div>
    </div>

    <script>
        window.onload = function() {
            // Verifica se o authToken está presente no sessionStorage
            const authToken = sessionStorage.getItem('authToken');

            if (authToken) {
                document.querySelector('.container').style.display = 'block';
            } else {
                window.location.href = '/';
            }

            const addItemBtn = document.getElementById('addItemBtn');
            const editItemBtn = document.getElementById('editItemBtn');
            const itemForm = document.getElementById('itemForm');
            const searchBar = document.getElementById('searchBar');
            const formTitle = document.getElementById('formTitle');

            // Evento para o botão "Adicionar Item"
            addItemBtn.addEventListener('click', () => {
                formTitle.textContent = 'Adicionar Item';
                itemForm.style.display = 'block';
                searchBar.style.display = 'none';
                clearForm();
            });

            // Evento para o botão "Editar Item"
            editItemBtn.addEventListener('click', () => {
                formTitle.textContent = 'Editar Item';
                itemForm.style.display = 'block';
                searchBar.style.display = 'block';
                loadItems();
            });

            // Função para limpar o formulário
            function clearForm() {
                document.getElementById('itemId').value = '';
                document.getElementById('itemName').value = '';
                document.getElementById('itemDescription').value = '';
                document.getElementById('itemPrice').value = '';
                document.getElementById('itemStatus').value = '';
                // Limpar outros campos...
            }

            // Função para carregar itens na barra de pesquisa
            function loadItems() {
                fetch('https://raw.githubusercontent.com/Grand-Guide/Grand-Guide.github.io/main/public/pages/items/items.json')
                    .then(response => response.json())
                    .then(data => {
                        const searchInput = document.getElementById('searchInput');
                        searchInput.addEventListener('input', function() {
                            const searchTerm = searchInput.value.toLowerCase();
                            const matchedItem = data.find(item => item.name.toLowerCase().includes(searchTerm) || item.id.toString() === searchTerm);
                            if (matchedItem) {
                                fillForm(matchedItem);
                            }
                        });
                    });
            }

            // Função para preencher o formulário com os dados do item
            function fillForm(item) {
                document.getElementById('itemId').value = item.id;
                document.getElementById('itemName').value = item.name;
                document.getElementById('itemDescription').value = item.description;
                document.getElementById('itemPrice').value = item.price;
                document.getElementById('itemStatus').value = item.status;
                // Preencher outros campos...
            }
        };
    </script>
</body>
</html>