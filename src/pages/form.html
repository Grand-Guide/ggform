<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulário de Submissão</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/src/pages/form.css">
</head>
<body>
    <!-- Verificação de Autenticação -->
    <script src="/auth.js"></script>

    <div class="container">
        <!-- Menu de Navegação -->
        <div class="menu">
            <button id="add-item" class="button">Adicionar Item</button>
            <button id="edit-item" class="button">Editar Item</button>
        </div>

        <!-- Seção de Adicionar Item -->
        <div id="add-item-section" class="section">
            <h1>Adicionar Novo Item</h1>
            <form id="submission-form">
                <label for="title">Título</label>
                <input type="text" id="title" name="title" required>

                <label for="cover">Imagem</label>
                <input type="text" id="cover" name="cover" required>

                <label for="description">Descrição</label>
                <textarea id="description" name="description" rows="4" required></textarea>

                <label for="price">Preço</label>
                <input type="text" id="price" name="price" required>

                <label for="quality">Qualidade</label>
                <input type="text" id="quality" name="quality" required>

                <label for="update">Atualização</label>
                <input type="text" id="update" name="update">

                <label for="status">Status</label>
                <input type="text" id="status" name="status">

                <label for="shop">Loja</label>
                <input type="text" id="shop" name="shop">

                <label for="hunting">Caça</label>
                <input type="text" id="hunting" name="hunting">

                <label for="recipe">Receita</label>
                <input type="text" id="recipe" name="recipe">

                <label for="videos">Vídeos</label>
                <input type="text" id="videos" name="videos">

                <button type="submit">Enviar</button>
            </form>
        </div>

        <!-- Seção de Editar Item -->
        <div id="edit-item-section" class="section" style="display: none;">
            <h1>Editar Item</h1>
            <label for="search">Pesquisar Item</label>
            <input type="text" id="search" name="search" placeholder="Digite o ID ou nome do item">
            <button id="search-btn" class="button">Pesquisar</button>

            <div id="edit-form-container" style="display: none;">
                <!-- O formulário para edição será inserido aqui -->
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const addItemSection = document.getElementById('add-item-section');
            const editItemSection = document.getElementById('edit-item-section');
            const addItemButton = document.getElementById('add-item');
            const editItemButton = document.getElementById('edit-item');
            const searchButton = document.getElementById('search-btn');
            const searchInput = document.getElementById('search');
            const editFormContainer = document.getElementById('edit-form-container');

            addItemButton.addEventListener('click', () => {
                addItemSection.style.display = 'block';
                editItemSection.style.display = 'none';
            });

            editItemButton.addEventListener('click', () => {
                addItemSection.style.display = 'none';
                editItemSection.style.display = 'block';
            });

            searchButton.addEventListener('click', () => {
                const query = searchInput.value;

                // Pesquisar o item
                fetch('https://raw.githubusercontent.com/Grand-Guide/Grand-Guide.github.io/main/public/pages/items/items.json')
                    .then(response => response.json())
                    .then(data => {
                        const item = data.find(item => item.id === query || item.name.toLowerCase() === query.toLowerCase());

                        if (item) {
                            // Criar e exibir formulário de edição
                            editFormContainer.innerHTML = `
                                <form id="edit-form">
                                    <label for="edit-title">Título</label>
                                    <input type="text" id="edit-title" name="title" value="${item.name}" required>

                                    <label for="edit-cover">Imagem</label>
                                    <input type="text" id="edit-cover" name="cover" value="${item.cover}" required>

                                    <label for="edit-description">Descrição</label>
                                    <textarea id="edit-description" name="description" rows="4" required>${item.description}</textarea>

                                    <label for="edit-price">Preço</label>
                                    <input type="text" id="edit-price" name="price" value="${item.price}" required>

                                    <label for="edit-quality">Qualidade</label>
                                    <input type="text" id="edit-quality" name="quality" value="${item.quality}" required>

                                    <label for="edit-update">Atualização</label>
                                    <input type="text" id="edit-update" name="update" value="${item.update}">

                                    <label for="edit-status">Status</label>
                                    <input type="text" id="edit-status" name="status" value="${item.status}">

                                    <label for="edit-shop">Loja</label>
                                    <input type="text" id="edit-shop" name="shop" value="${item.shop}">

                                    <label for="edit-hunting">Caça</label>
                                    <input type="text" id="edit-hunting" name="hunting" value="${item.hunting}">

                                    <label for="edit-recipe">Receita</label>
                                    <input type="text" id="edit-recipe" name="recipe" value="${item.recipe}">

                                    <label for="edit-videos">Vídeos</label>
                                    <input type="text" id="edit-videos" name="videos" value="${item.videos}">

                                    <button type="submit">Atualizar</button>
                                </form>
                            `;
                            document.getElementById('edit-form').addEventListener('submit', function(event) {
                                event.preventDefault();

                                // Obter os dados do formulário
                                const updatedItem = {
                                    id: item.id,
                                    name: document.getElementById('edit-title').value,
                                    cover: document.getElementById('edit-cover').value,
                                    description: document.getElementById('edit-description').value,
                                    price: document.getElementById('edit-price').value,
                                    quality: document.getElementById('edit-quality').value,
                                    update: document.getElementById('edit-update').value,
                                    status: document.getElementById('edit-status').value,
                                    shop: document.getElementById('edit-shop').value,
                                    hunting: document.getElementById('edit-hunting').value,
                                    recipe: document.getElementById('edit-recipe').value,
                                    videos: document.getElementById('edit-videos').value
                                };

                                // Atualizar o item no GitHub (aqui você deve integrar com a API do GitHub para atualizar o item)
                                console.log('Item atualizado:', updatedItem);

                                alert('Item atualizado com sucesso!');
                            });
                        } else {
                            alert('Item não encontrado.');
                        }
                    })
                    .catch(error => console.error('Erro ao carregar itens:', error));
            });
        });
    </script>
</body>
</html>
